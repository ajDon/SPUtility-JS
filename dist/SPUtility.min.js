"use strict";var SPUtility=function(A){return function(){var e,o=void 0,r=!1,i="application/json;odata=verbose",a=!0,n={},s=_spPageContextInfo||{},l=function(t){o=t,r=!0,n={},u().then(function(t){e=t.d.GetContextWebInformation.FormDigestValue,setTimeout(function(){l(o)},100*t.d.GetContextWebInformation.FormDigestTimeoutSeconds-100)})},u=function(){return _({url:o+"/_api/contextinfo",contentType:"application/json;odata=verbose",headers:{accept:"application/json;odata=verbose"}})},p=function(){return r||(e=e||A("#__REQUESTDIGEST").val()),e},t=function(){this.batchGuid=c(),this.changeSetId=c(),this.batchContents=new Array};t.prototype.addToBatchContent=function(t){this.batchContents.push("--changeset_"+this.changeSetId),this.batchContents.push("Content-Type: application/http"),this.batchContents.push("Content-Transfer-Encoding: binary"),this.batchContents.push(""),this.batchContents.push(t.type+" "+t.url+" HTTP/1.1");for(var e=0;e<t.headers.length;e++){var r=t.headers[e];this.batchContents.push(r)}this.batchContents.push(""),t.data&&(this.batchContents.push(JSON.stringify(t.data)),this.batchContents.push(""))},t.prototype.executeBatch=function(){this.batchContents.push("--changeset_"+this.changeSetId+"--");var t=this.batchContents.join("\r\n");this.batchContents=new Array,this.batchContents.push("--batch_"+this.batchGuid),this.batchContents.push('Content-Type: multipart/mixed; boundary="changeset_'+this.changeSetId+'"'),this.batchContents.push("Content-Length: "+t.length),this.batchContents.push("Content-Transfer-Encoding: binary"),this.batchContents.push(""),this.batchContents.push(t),this.batchContents.push(""),this.batchContents.push("--batch_"+this.batchGuid+"--"),t=this.batchContents.join("\r\n");var e={"X-RequestDigest":p(),"Content-Type":'multipart/mixed; boundary="batch_'+this.batchGuid+'"'},r=o+"/_api/$batch";return this.batchGuid=c(),this.changeSetId=c(),this.batchContents=new Array,_({url:r,headers:e,data:t})};var c=function(){var r=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=(r+16*Math.random())%16|0;return r=Math.floor(r/16),("x"==t?e:3&e|8).toString(16)})},d=function(t){this.endPointUrl=t};d.prototype.select=function(t){return t&&(this.selectArray=t.join(",")),this},d.prototype.filter=function(t){return t&&(this.filterValue=t),this},d.prototype.get=function(){var t=this.endPointUrl,e={};return this.selectArray&&(e.$select=this.selectArray),this.filterValue&&(e.$filter=this.filterValue),w({url:t+"/Fields",data:A.param(e)})};var h=(s=_spPageContextInfo||{},o=o||s.webAbsoluteUrl||"..",{lists:(C=x="",I=function(){var t=o,e=A.Deferred();return"getbytitle"===x.toLowerCase()?t+="/_api/lists/getbytitle('"+C+"')?$select=ListItemEntityTypeFullName":"getbyid"===x.toLowerCase()&&(t+="/_api/lists(guid'"+C+"')?$select=ListItemEntityTypeFullName"),n.listTitleOrId===C?e.resolve(n.MetaData):w({url:t,contentType:"application/json;odata=verbose",headers:{accept:"application/json;odata=verbose"}}).then(function(t){n={listTitleOrId:C,MetaData:t},e.resolve(t)},function(t){e.reject(t)}),e.promise()},v=function(t,e){return w({url:t+"/"+e})},(L=function(){}).prototype.select=function(t){return t&&(this.selectArray=t.join(",")),this},L.prototype.expand=function(t){return t&&(this.expandArray=t.join(",")),this},L.prototype.filter=function(t){return t&&(this.filterValue=t),this},L.prototype.topItem=function(t){return t&&(this.top=t),this},L.prototype.orderBy=function(t){return t&&(this.order=t.join(",")),this},L.prototype.get=function(){var t={};return this.selectArray&&(t.$select=this.selectArray),this.expandArray&&(t.$expand=this.expandArray),this.filterValue&&(t.$filter=this.filterValue),this.top&&(t.$top=this.top),this.order&&(t.$orderby=this.order),"getbytitle"===x.toLowerCase()?w({url:o+"/_api/lists/getbytitle('"+C+"')/items",data:A.param(t)}):"getbyid"===x.toLowerCase()?w({url:o+"/_api/lists(guid'"+C+"')/items",data:A.param(t)}):void 0},L.prototype.getAllItems=function(){var r=A.Deferred(),t={},e=o,i=[];"getbytitle"===x.toLowerCase()?e+="/_api/lists/getbytitle('"+C+"')/items":"getbyid"===x.toLowerCase()&&(e+="/_api/lists(guid'"+C+"')/items"),this.selectArray&&(t.$select=this.selectArray),this.expandArray&&(t.$expand=this.expandArray),this.filterValue&&(t.$filter=this.filterValue),this.order&&(t.$orderby=this.order),t.$top=4999,this.top&&(t.$top=this.top);var n=function(t,e){w({url:t,data:A.param(e)}).then(function(t){a?(i=A.merge(i,t.d.results),t.d.__next?n(t.d.__next,""):r.resolve(i)):(i=A.merge(i,t.value),t["odata.nextLink"]?n(t["odata.nextLink"],""):r.resolve(i))},function(t){console.error("Error occurred while loading the items",t),r.reject(t)})};return n(e,t),r.promise()},L.prototype.getPaged=function(){var r=A.Deferred(),t={},e=o;"getbytitle"===x.toLowerCase()?e+="/_api/lists/getbytitle('"+C+"')/items":"getbyid"===x.toLowerCase()&&(e+="/_api/lists(guid'"+C+"')/items"),this.selectArray&&(t.$select=this.selectArray),this.expandArray&&(t.$expand=this.expandArray),this.filterValue&&(t.$filter=this.filterValue),this.order&&(t.$orderby=this.order),t.$top=4999,this.top&&(t.$top=this.top);var i=function(t,e){var r=A.Deferred();return w({url:t,data:A.param(e)}).then(function(t){if(a?t.d.__next:t["odata.nextLink"]){var e=function(t){this.nextUrlLink=t};e.prototype.getNextItems=function(){return i(this.nextUrlLink,"")},a?r.resolve(t.d.results,new e(t.d.__next)):r.resolve(t.value,new e(t["odata.nextLink"]))}else a?r.resolve(t.d.results):r.resolve(t.value)},function(t){console.error("Error occurred while loading the items",t),r.reject(t)}),r.promise()};return i(e,t).then(function(t,e){e?r.resolve(t,e):r.resolve(t)},function(t){r.reject(t)}),r.promise()},L.prototype.getItemById=function(t){var e={},r=o;return this.selectArray&&(e.$select=this.selectArray),this.expandArray&&(e.$expand=this.expandArray),"getbytitle"===x.toLowerCase()?r+="/_api/lists/getbytitle('"+C+"')/getItemById('"+t+"')":"getbyid"===x.toLowerCase()&&(r+="/_api/lists(guid'"+C+"')/getItemById('"+t+"')"),w({url:r,data:A.param(e)})},L.prototype.addNewItem=function(e){var r=A.Deferred(),i=o;return"getbytitle"===x.toLowerCase()?i+="/_api/lists/getbytitle('"+C+"')/items":"getbyid"===x.toLowerCase()&&(i+="/_api/lists(guid'"+C+"')/items"),I().then(function(t){e.__metadata={type:t.d.ListItemEntityTypeFullName},_({url:i,data:JSON.stringify(e),contentType:"application/json;odata=verbose",headers:{accept:"application/json;odata=verbose"}}).then(function(t){r.resolve(t)},function(t){r.reject(t)})},function(t){console.error("Error occurred while loading List Metadata",t),r.reject(t)}),r.promise()},L.prototype.addNewItemUsingBatch=function(e,r){var i=o;"getbytitle"===x.toLowerCase()?i+="/_api/lists/getbytitle('"+C+"')/items":"getbyid"===x.toLowerCase()&&(i+="/_api/lists(guid'"+C+"')/items"),I().then(function(t){e.__metadata={type:t.d.ListItemEntityTypeFullName},r.addToBatchContent({url:i,type:"POST",headers:["Content-Type: application/json;odata=verbose"],data:e})},function(t){console.error("Error occurred",t)})},L.prototype.updateItem=function(t,e,r){var i=A.Deferred(),n=o;return"getbytitle"===x.toLowerCase()?n+="/_api/lists/getbytitle('"+C+"')/getItemById('"+t+"')":"getbyid"===x.toLowerCase()&&(n+="/_api/lists(guid'"+C+"')/getItemById('"+t+"')"),I().then(function(t){r.__metadata={type:t.d.ListItemEntityTypeFullName},_({url:n,data:JSON.stringify(r),contentType:"application/json;odata=verbose",headers:{accept:"application/json;odata=verbose","X-HTTP-Method":"MERGE","If-Match":e}}).then(function(t){i.resolve(t)},function(t){i.reject(t)})},function(t){console.error("Error occurred while loading List Metadata",t),i.reject(t)}),i.promise()},L.prototype.updateItemUsingBatch=function(t,e,r,i){var n=o;"getbytitle"===x.toLowerCase()?n+="/_api/lists/getbytitle('"+C+"')/getItemById('"+t+"')":"getbyid"===x.toLowerCase()&&(n+="/_api/lists(guid'"+C+"')/getItemById('"+t+"')"),I().then(function(t){r.__metadata={type:t.d.ListItemEntityTypeFullName},i.addToBatchContent({url:n,type:"PATCH",headers:["Content-Type: application/json;odata=verbose","If-Match: "+e],data:r})},function(t){console.error("Error occurred",t)})},L.prototype.deleteItem=function(t,e){var r=o;return"getbytitle"===x.toLowerCase()?r+="/_api/lists/getbytitle('"+C+"')/getItemById('"+t+"')":"getbyid"===x.toLowerCase()&&(r+="/_api/lists(guid'"+C+"')/getItemById('"+t+"')"),_({url:r,contentType:"application/json;odata=verbose",headers:{accept:"application/json;odata=verbose","X-HTTP-Method":"DELETE","If-Match":e}})},L.prototype.deleteItemUsingBatch=function(t,e,r){var i=o;"getbytitle"===x.toLowerCase()?i+="/_api/lists/getbytitle('"+C+"')/getItemById('"+t+"')":"getbyid"===x.toLowerCase()&&(i+="/_api/lists(guid'"+C+"')/getItemById('"+t+"')"),r.addToBatchContent({url:i,type:"DELETE",headers:["Content-Type: application/json;odata=verbose","If-Match: "+e]})},L.prototype.hasuniqueroleassignments=function(t){var e=o;return"getbytitle"===x.toLowerCase()?e+="/_api/lists/getbytitle('"+C+"')/getItemById('"+t+"')":"getbyid"===x.toLowerCase()&&(e+="/_api/lists(guid'"+C+"')/getItemById('"+t+"')"),y(e)},L.prototype.breakroleinheritance=function(t,e,r){var i=o;return"getbytitle"===x.toLowerCase()?i+="/_api/lists/getbytitle('"+C+"')/getItemById('"+t+"')":"getbyid"===x.toLowerCase()&&(i+="/_api/lists(guid'"+C+"')/getItemById('"+t+"')"),g(i,e,r)},L.prototype.resetroleinheritance=function(t){var e=o;return"getbytitle"===x.toLowerCase()?e+="/_api/lists/getbytitle('"+C+"')/getItemById('"+t+"')":"getbyid"===x.toLowerCase()&&(e+="/_api/lists(guid'"+C+"')/getItemById('"+t+"')"),f(e)},L.prototype.addRoleAssignment=function(t,e,r){var i=o;return"getbytitle"===x.toLowerCase()?i+="/_api/lists/getbytitle('"+C+"')/getItemById('"+t+"')":"getbyid"===x.toLowerCase()&&(i+="/_api/lists(guid'"+C+"')/getItemById('"+t+"')"),b(i,e,r)},L.prototype.deleteRoleAssignment=function(t,e){var r=o;return"getbytitle"===x.toLowerCase()?r+="/_api/lists/getbytitle('"+C+"')/getItemById('"+t+"')":"getbyid"===x.toLowerCase()&&(r+="/_api/lists(guid'"+C+"')/getItemById('"+t+"')"),m(r,e)},{getListByTitle:function(t){if(!t)throw new Error("List Title cannot be empty or null");return x="getbytitle",C=t,{Items:new L,hasuniqueroleassignments:function(){return y(o+"/_api/lists/getbytitle('"+C+"')")},breakroleinheritance:function(t,e){return g(o+"/_api/lists/getbytitle('"+C+"')",t,e)},resetroleinheritance:function(){return f(o+"/_api/lists/getbytitle('"+C+"')")},addRoleAssignment:function(t,e){return b(o+"/_api/lists/getbytitle('"+C+"')",t,e)},deleteRoleAssignment:function(t){return m(o+"/_api/lists/getbytitle('"+C+"')",t)},getDefaultDisplayFormUrl:function(){return v(o+"/_api/lists/getbytitle('"+C+"')","DefaultDisplayFormUrl")},getDefaultEditFormUrl:function(){return v(o+"/_api/lists/getbytitle('"+C+"')","DefaultEditFormUrl")},getDefaultNewFormUrl:function(){return v(o+"/_api/lists/getbytitle('"+C+"')","DefaultNewFormUrl")},Fields:new d(o+"/_api/lists/getbytitle('"+C+"')")}},getListById:function(t){if(!t)throw new Error("List Id cannot be empty or null");return x="getbyid",C=t,{Items:new L,hasuniqueroleassignments:function(){return y(o+"/_api/lists(guid'"+C+"')")},breakroleinheritance:function(t,e){return g(o+"/_api/lists(guid'"+C+"')",t,e)},resetroleinheritance:function(){return f(o+"/_api/lists(guid'"+C+"')")},addRoleAssignment:function(t,e){return b(o+"/_api/lists(guid'"+C+"')",t,e)},deleteRoleAssignment:function(t){return m(o+"/_api/lists(guid'"+C+"')",t)},getDefaultDisplayFormUrl:function(){return v(o+"/_api/lists(guid'"+C+"')","DefaultDisplayFormUrl")},getDefaultEditFormUrl:function(){return v(o+"/_api/lists(guid'"+C+"')","DefaultEditFormUrl")},getDefaultNewFormUrl:function(){return v(o+"/_api/lists(guid'"+C+"')","DefaultNewFormUrl")},Fields:new d(o+"/_api/lists(guid'"+C+"')")}}}),ensureUser:function(t){if(!t)throw new Error("Logon Name cannot be null");var e={logonName:t};return _({url:o+"/_api/web/ensureuser",data:JSON.stringify(e)})},currentUser:function(){return w({url:o+"/_api/web/CurrentUser"})},siteGroups:function(){var r,i,t=function(){};t.prototype.select=function(t){return t&&(this.selectArray=t.join(",")),this},t.prototype.expand=function(t){return t&&(this.expandArray=t.join(",")),this},t.prototype.filter=function(t){return t&&(this.filterValue=t),this},t.prototype.getAllGroups=function(){var t={};return this.selectArray&&(t.$select=this.selectArray),this.expandArray&&(t.$expand=this.expandArray),this.filterValue&&(t.$filter=this.filterValue),w({url:o+"/_api/web/sitegroups",data:A.param(t)})},t.prototype.getByName=function(t){return i="getbyname",r=t,{users:new e,get:function(){return w({url:o+"/_api/web/sitegroups/getbyname('"+t+"')"})}}},t.prototype.getById=function(t){return i="getbyid",r=t,{users:new e,get:function(){return w({url:o+"/_api/web/sitegroups/getbyid('"+t+"')"})}}};var e=function(){};return e.prototype.select=function(t){return t&&(this.selectArray=t.join(",")),this},e.prototype.expand=function(t){return t&&(this.expandArray=t.join(",")),this},e.prototype.filter=function(t){return t&&(this.filterValue=t),this},e.prototype.get=function(){var t={},e=o+"/_api/web/sitegroups/";return"getbyname"===i.toLowerCase()?e+="getbyname('"+r+"')/users":"getbyid"===i.toLowerCase()&&(e+="getbyid("+r+")/users"),this.selectArray&&(t.$select=this.selectArray),this.expandArray&&(t.$expand=this.expandArray),this.filterValue&&(t.$filter=this.filterValue),w({url:e,data:A.param(t)})},{groups:new t}}(),getRoles:function(){return w({url:o+"/_api/web/roleDefinitions"})},hasuniqueroleassignments:function(){return y(o+"/_api/web")},breakroleinheritance:function(t,e){return g(o+"/_api/web",t,e)},resetroleinheritance:function(){return f(o+"/_api/web")},addRoleAssignment:function(t,e){return b(o+"/_api/web",t,e)},deleteRoleAssignment:function(t){return m(o+"/_api/web",t)},siteColumns:function(){return{Fields:new d(o+"/_api/web")}}}),y=function(t){return _({url:t+="/hasuniqueroleassignments"})},g=function(t,e,r){return t+="/breakroleinheritance(copyRoleAssignments="+e.toString()+",clearSubscopes="+r.toString()+")",_({url:t})},f=function(t){return _({url:t+="/resetroleinheritance"})},b=function(t,e,r){return endpointUri+=",roledefid="+r+")",_(t+="/roleassignments/addroleassignment(principalid="+e,{})},m=function(t,e){return _({url:t+="/roleassignments/getbyprincipalid("+e+")",headers:{"X-HTTP-Method":"DELETE"}})},_=function(t){var e={type:"POST",contentType:i},r=A.extend({},e,t);return void 0===r.headers||null===r.headers?r.headers={"X-RequestDigest":p(),accept:i}:A.extend(r.headers,{"X-RequestDigest":p(),accept:i}),A.ajax(r)},w=function(t){var e={type:"GET",contentType:i,headers:{accept:i}},r=A.extend({},e,t);return A.ajax(r)};var x,C,I,v,L;return{web:h,setSiteUrl:l,setNoMetaData:function(t){a=t?!(i="application/json;odata=nometadata"):(i="application/json;odata=verbose",!0)},getUserProperties:function(t,e){return s=_spPageContextInfo||{},o=o||s.webAbsoluteUrl||"..",w({url:o+"/_api/SP.UserProfiles.PeopleManager/GetUserProfilePropertyFor(accountName=@v,propertyName='"+e+"')?@v='i:0%23.f|membership|"+t+"'"})},getAllUserProperties:function(t){return s=_spPageContextInfo||{},o=o||s.webAbsoluteUrl||"..",w({url:o+"/_api/SP.UserProfiles.PeopleManager/GetPropertiesFor(accountName=@v)?@v='i:0%23.f|membership|"+encodeURIComponent(t)+"'"})},getAllPropertiesOfCurrentUser:function(){return s=_spPageContextInfo||{},o=o||s.webAbsoluteUrl||"..",w({url:o+"/_api/SP.UserProfiles.PeopleManager/GetMyProperties"})},getRequestDigest:p,setMinimalMetaData:function(t){a=t?!(i="application/json;odata=minimalmetadata"):(i="application/json;odata=verbose",!0)},createNewBatch:t}}}(jQuery);