!function(x){window.SPUtility=function(){var e,l=void 0,r=!1,i="application/json;odata=verbose",u=!0,n={},p=_spPageContextInfo||{},o=function(t){l=t,r=!0,n={},a().then(function(t){e=t.d.GetContextWebInformation.FormDigestValue,setTimeout(function(){o(l)},100*t.d.GetContextWebInformation.FormDigestTimeoutSeconds-100)})},a=function(){return _({url:l+"/_api/contextinfo",contentType:"application/json;odata=verbose",headers:{accept:"application/json;odata=verbose"}})},s=function(){return r||(e=e||x("#__REQUESTDIGEST").val()),e},t=function(){this.batchGuid=c(),this.changeSetId=c(),this.batchContents=new Array};t.prototype.addToBatchContent=function(t){this.batchContents.push("--changeset_"+this.changeSetId),this.batchContents.push("Content-Type: application/http"),this.batchContents.push("Content-Transfer-Encoding: binary"),this.batchContents.push(""),this.batchContents.push(t.type+" "+t.url+" HTTP/1.1");for(var e=0;e<t.headers.length;e++){var r=t.headers[e];this.batchContents.push(r)}this.batchContents.push(""),t.data&&(this.batchContents.push(JSON.stringify(t.data)),this.batchContents.push(""))},t.prototype.executeBatch=function(){this.batchContents.push("--changeset_"+this.changeSetId+"--");var t=this.batchContents.join("\r\n");this.batchContents=new Array,this.batchContents.push("--batch_"+this.batchGuid),this.batchContents.push('Content-Type: multipart/mixed; boundary="changeset_'+this.changeSetId+'"'),this.batchContents.push("Content-Length: "+t.length),this.batchContents.push("Content-Transfer-Encoding: binary"),this.batchContents.push(""),this.batchContents.push(t),this.batchContents.push(""),this.batchContents.push("--batch_"+this.batchGuid+"--"),t=this.batchContents.join("\r\n");var e={"X-RequestDigest":s(),"Content-Type":'multipart/mixed; boundary="batch_'+this.batchGuid+'"'},r=l+"/_api/$batch";return this.batchGuid=c(),this.changeSetId=c(),this.batchContents=new Array,_({url:r,headers:e,data:t})};var c=function(){var r=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=(r+16*Math.random())%16|0;return r=Math.floor(r/16),("x"==t?e:3&e|8).toString(16)})},d=function(t){this.endPointUrl=t};d.prototype.select=function(t){return t&&(this.selectArray=t.join(",")),this},d.prototype.filter=function(t){return t&&(this.filterValue=t),this},d.prototype.get=function(){var t=this.endPointUrl,e={};return this.selectArray&&(e.$select=this.selectArray),this.filterValue&&(e.$filter=this.filterValue),w({url:t+"/Fields",data:x.param(e)})};var h=function(){p=_spPageContextInfo||{},l=l||p.webAbsoluteUrl||"..";var o,a,s,e,r;return{lists:(a=o="",s=function(){var t=l,e=x.Deferred();return"getbytitle"===o.toLowerCase()?t+="/_api/lists/getbytitle('"+a+"')?$select=ListItemEntityTypeFullName":"getbyid"===o.toLowerCase()&&(t+="/_api/lists(guid'"+a+"')?$select=ListItemEntityTypeFullName"),n.listTitleOrId===a?e.resolve(n.MetaData):w({url:t,contentType:"application/json;odata=verbose",headers:{accept:"application/json;odata=verbose"}}).then(function(t){n={listTitleOrId:a,MetaData:t},e.resolve(t)},function(t){e.reject(t)}),e.promise()},e=function(t,e){return w({url:t+"/"+e})},(r=function(){}).prototype.select=function(t){return t&&(this.selectArray=t.join(",")),this},r.prototype.expand=function(t){return t&&(this.expandArray=t.join(",")),this},r.prototype.filter=function(t){return t&&(this.filterValue=t),this},r.prototype.topItem=function(t){return t&&(this.top=t),this},r.prototype.orderBy=function(t){return t&&(this.order=t.join(",")),this},r.prototype.get=function(){var t={};return this.selectArray&&(t.$select=this.selectArray),this.expandArray&&(t.$expand=this.expandArray),this.filterValue&&(t.$filter=this.filterValue),this.top&&(t.$top=this.top),this.order&&(t.$orderby=this.order),"getbytitle"===o.toLowerCase()?w({url:l+"/_api/lists/getbytitle('"+a+"')/items",data:x.param(t)}):"getbyid"===o.toLowerCase()?w({url:l+"/_api/lists(guid'"+a+"')/items",data:x.param(t)}):void 0},r.prototype.getAllItems=function(){var r=x.Deferred(),t={},e=l,i=[];"getbytitle"===o.toLowerCase()?e+="/_api/lists/getbytitle('"+a+"')/items":"getbyid"===o.toLowerCase()&&(e+="/_api/lists(guid'"+a+"')/items"),this.selectArray&&(t.$select=this.selectArray),this.expandArray&&(t.$expand=this.expandArray),this.filterValue&&(t.$filter=this.filterValue),this.order&&(t.$orderby=this.order),t.$top=4999,this.top&&(t.$top=this.top);var n=function(t,e){w({url:t,data:x.param(e)}).then(function(t){u?(i=x.merge(i,t.d.results),t.d.__next?n(t.d.__next,""):r.resolve(i)):(i=x.merge(i,t.value),t["odata.nextLink"]?n(t["odata.nextLink"],""):r.resolve(i))},function(t){console.error("Error occurred while loading the items",t),r.reject(t)})};return n(e,t),r.promise()},r.prototype.getPaged=function(){var r=x.Deferred(),t={},e=l;"getbytitle"===o.toLowerCase()?e+="/_api/lists/getbytitle('"+a+"')/items":"getbyid"===o.toLowerCase()&&(e+="/_api/lists(guid'"+a+"')/items"),this.selectArray&&(t.$select=this.selectArray),this.expandArray&&(t.$expand=this.expandArray),this.filterValue&&(t.$filter=this.filterValue),this.order&&(t.$orderby=this.order),t.$top=4999,this.top&&(t.$top=this.top);var i=function(t,e){var r=x.Deferred();return w({url:t,data:x.param(e)}).then(function(t){if(u?t.d.__next:t["odata.nextLink"]){var e=function(t){this.nextUrlLink=t};e.prototype.getNextItems=function(){return i(this.nextUrlLink,"")},u?r.resolve(t.d.results,new e(t.d.__next)):r.resolve(t.value,new e(t["odata.nextLink"]))}else u?r.resolve(t.d.results):r.resolve(t.value)},function(t){console.error("Error occurred while loading the items",t),r.reject(t)}),r.promise()};return i(e,t).then(function(t,e){e?r.resolve(t,e):r.resolve(t)},function(t){r.reject(t)}),r.promise()},r.prototype.getItemById=function(t){var e={},r=l;return this.selectArray&&(e.$select=this.selectArray),this.expandArray&&(e.$expand=this.expandArray),"getbytitle"===o.toLowerCase()?r+="/_api/lists/getbytitle('"+a+"')/getItemById('"+t+"')":"getbyid"===o.toLowerCase()&&(r+="/_api/lists(guid'"+a+"')/getItemById('"+t+"')"),w({url:r,data:x.param(e)})},r.prototype.addNewItem=function(e){var r=x.Deferred(),i=l;return"getbytitle"===o.toLowerCase()?i+="/_api/lists/getbytitle('"+a+"')/items":"getbyid"===o.toLowerCase()&&(i+="/_api/lists(guid'"+a+"')/items"),s().then(function(t){e.__metadata={type:t.d.ListItemEntityTypeFullName},_({url:i,data:JSON.stringify(e),contentType:"application/json;odata=verbose",headers:{accept:"application/json;odata=verbose"}}).then(function(t){r.resolve(t)},function(t){r.reject(t)})},function(t){console.error("Error occurred while loading List Metadata",t),r.reject(t)}),r.promise()},r.prototype.addNewItemUsingBatch=function(e,r){var i=l;"getbytitle"===o.toLowerCase()?i+="/_api/lists/getbytitle('"+a+"')/items":"getbyid"===o.toLowerCase()&&(i+="/_api/lists(guid'"+a+"')/items"),s().then(function(t){e.__metadata={type:t.d.ListItemEntityTypeFullName},r.addToBatchContent({url:i,type:"POST",headers:["Content-Type: application/json;odata=verbose"],data:e})},function(t){console.error("Error occurred",t)})},r.prototype.updateItem=function(t,e,r){var i=x.Deferred(),n=l;return"getbytitle"===o.toLowerCase()?n+="/_api/lists/getbytitle('"+a+"')/getItemById('"+t+"')":"getbyid"===o.toLowerCase()&&(n+="/_api/lists(guid'"+a+"')/getItemById('"+t+"')"),s().then(function(t){r.__metadata={type:t.d.ListItemEntityTypeFullName},_({url:n,data:JSON.stringify(r),contentType:"application/json;odata=verbose",headers:{accept:"application/json;odata=verbose","X-HTTP-Method":"MERGE","If-Match":e}}).then(function(t){i.resolve(t)},function(t){i.reject(t)})},function(t){console.error("Error occurred while loading List Metadata",t),i.reject(t)}),i.promise()},r.prototype.updateItemUsingBatch=function(t,e,r,i){var n=l;"getbytitle"===o.toLowerCase()?n+="/_api/lists/getbytitle('"+a+"')/getItemById('"+t+"')":"getbyid"===o.toLowerCase()&&(n+="/_api/lists(guid'"+a+"')/getItemById('"+t+"')"),s().then(function(t){r.__metadata={type:t.d.ListItemEntityTypeFullName},i.addToBatchContent({url:n,type:"PATCH",headers:["Content-Type: application/json;odata=verbose","If-Match: "+e],data:r})},function(t){console.error("Error occurred",t)})},r.prototype.deleteItem=function(t,e){var r=l;return"getbytitle"===o.toLowerCase()?r+="/_api/lists/getbytitle('"+a+"')/getItemById('"+t+"')":"getbyid"===o.toLowerCase()&&(r+="/_api/lists(guid'"+a+"')/getItemById('"+t+"')"),_({url:r,contentType:"application/json;odata=verbose",headers:{accept:"application/json;odata=verbose","X-HTTP-Method":"DELETE","If-Match":e}})},r.prototype.deleteItemUsingBatch=function(t,e,r){var i=l;"getbytitle"===o.toLowerCase()?i+="/_api/lists/getbytitle('"+a+"')/getItemById('"+t+"')":"getbyid"===o.toLowerCase()&&(i+="/_api/lists(guid'"+a+"')/getItemById('"+t+"')"),r.addToBatchContent({url:i,type:"DELETE",headers:["Content-Type: application/json;odata=verbose","If-Match: "+e]})},r.prototype.hasuniqueroleassignments=function(t){var e=l;return"getbytitle"===o.toLowerCase()?e+="/_api/lists/getbytitle('"+a+"')/getItemById('"+t+"')":"getbyid"===o.toLowerCase()&&(e+="/_api/lists(guid'"+a+"')/getItemById('"+t+"')"),y(e)},r.prototype.breakroleinheritance=function(t,e,r){var i=l;return"getbytitle"===o.toLowerCase()?i+="/_api/lists/getbytitle('"+a+"')/getItemById('"+t+"')":"getbyid"===o.toLowerCase()&&(i+="/_api/lists(guid'"+a+"')/getItemById('"+t+"')"),g(i,e,r)},r.prototype.resetroleinheritance=function(t){var e=l;return"getbytitle"===o.toLowerCase()?e+="/_api/lists/getbytitle('"+a+"')/getItemById('"+t+"')":"getbyid"===o.toLowerCase()&&(e+="/_api/lists(guid'"+a+"')/getItemById('"+t+"')"),f(e)},r.prototype.addRoleAssignment=function(t,e,r){var i=l;return"getbytitle"===o.toLowerCase()?i+="/_api/lists/getbytitle('"+a+"')/getItemById('"+t+"')":"getbyid"===o.toLowerCase()&&(i+="/_api/lists(guid'"+a+"')/getItemById('"+t+"')"),b(i,e,r)},r.prototype.deleteRoleAssignment=function(t,e){var r=l;return"getbytitle"===o.toLowerCase()?r+="/_api/lists/getbytitle('"+a+"')/getItemById('"+t+"')":"getbyid"===o.toLowerCase()&&(r+="/_api/lists(guid'"+a+"')/getItemById('"+t+"')"),m(r,e)},{getListByTitle:function(t){if(!t)throw new Error("List Title cannot be empty or null");return o="getbytitle",a=t,{Items:new r,hasuniqueroleassignments:function(){return y(l+"/_api/lists/getbytitle('"+a+"')")},breakroleinheritance:function(t,e){return g(l+"/_api/lists/getbytitle('"+a+"')",t,e)},resetroleinheritance:function(){return f(l+"/_api/lists/getbytitle('"+a+"')")},addRoleAssignment:function(t,e){return b(l+"/_api/lists/getbytitle('"+a+"')",t,e)},deleteRoleAssignment:function(t){return m(l+"/_api/lists/getbytitle('"+a+"')",t)},getDefaultDisplayFormUrl:function(){return e(l+"/_api/lists/getbytitle('"+a+"')","DefaultDisplayFormUrl")},getDefaultEditFormUrl:function(){return e(l+"/_api/lists/getbytitle('"+a+"')","DefaultEditFormUrl")},getDefaultNewFormUrl:function(){return e(l+"/_api/lists/getbytitle('"+a+"')","DefaultNewFormUrl")},Fields:new d(l+"/_api/lists/getbytitle('"+a+"')")}},getListById:function(t){if(!t)throw new Error("List Id cannot be empty or null");return o="getbyid",a=t,{Items:new r,hasuniqueroleassignments:function(){return y(l+"/_api/lists(guid'"+a+"')")},breakroleinheritance:function(t,e){return g(l+"/_api/lists(guid'"+a+"')",t,e)},resetroleinheritance:function(){return f(l+"/_api/lists(guid'"+a+"')")},addRoleAssignment:function(t,e){return b(l+"/_api/lists(guid'"+a+"')",t,role)},deleteRoleAssignment:function(t){return m(l+"/_api/lists(guid'"+a+"')",t)},getDefaultDisplayFormUrl:function(){return e(l+"/_api/lists(guid'"+a+"')","DefaultDisplayFormUrl")},getDefaultEditFormUrl:function(){return e(l+"/_api/lists(guid'"+a+"')","DefaultEditFormUrl")},getDefaultNewFormUrl:function(){return e(l+"/_api/lists(guid'"+a+"')","DefaultNewFormUrl")},Fields:new d(l+"/_api/lists(guid'"+a+"')")}}}),ensureUser:function(t){if(!t)throw new Error("Logon Name cannot be null");var e={logonName:t};return _({url:l+"/_api/web/ensureuser",data:JSON.stringify(e)})},currentUser:function(){return w({url:l+"/_api/web/CurrentUser"})},siteGroups:function(){var r,i,t=function(){};t.prototype.select=function(t){return t&&(this.selectArray=t.join(",")),this},t.prototype.expand=function(t){return t&&(this.expandArray=t.join(",")),this},t.prototype.filter=function(t){return t&&(this.filterValue=t),this},t.prototype.getAllGroups=function(){var t={};return this.selectArray&&(t.$select=this.selectArray),this.expandArray&&(t.$expand=this.expandArray),this.filterValue&&(t.$filter=this.filterValue),w({url:l+"/_api/web/sitegroups",data:x.param(t)})},t.prototype.getByName=function(t){i="getbyname",r=t;return{users:new e,get:function(){return w({url:l+"/_api/web/sitegroups/getbyname('"+t+"')"})}}},t.prototype.getById=function(t){i="getbyid",r=t;return{users:new e,get:function(){return w({url:l+"/_api/web/sitegroups/getbyid('"+t+"')"})}}};var e=function(){};return e.prototype.select=function(t){return t&&(this.selectArray=t.join(",")),this},e.prototype.expand=function(t){return t&&(this.expandArray=t.join(",")),this},e.prototype.filter=function(t){return t&&(this.filterValue=t),this},e.prototype.get=function(){var t={},e=l+"/_api/web/sitegroups/";return"getbyname"===i.toLowerCase()?e+="getbyname('"+r+"')/users":"getbyid"===i.toLowerCase()&&(e+="getbyid("+r+")/users"),this.selectArray&&(t.$select=this.selectArray),this.expandArray&&(t.$expand=this.expandArray),this.filterValue&&(t.$filter=this.filterValue),w({url:e,data:x.param(t)})},{groups:new t}}(),getRoles:function(){return w({url:l+"/_api/web/roleDefinitions"})},hasuniqueroleassignments:function(){return y(l+"/_api/web")},breakroleinheritance:function(t,e){return g(l+"/_api/web",t,e)},resetroleinheritance:function(){return f(l+"/_api/web")},addRoleAssignment:function(t,e){return b(l+"/_api/web",t,e)},deleteRoleAssignment:function(t){return m(l+"/_api/web",t)},siteColumns:function(){return{Fields:new d(l+"/_api/web")}}}}(),y=function(t){return _({url:t+="/hasuniqueroleassignments"})},g=function(t,e,r){return t+="/breakroleinheritance(copyRoleAssignments="+e.toString()+",clearSubscopes="+r.toString()+")",_({url:t})},f=function(t){return _({url:t+="/resetroleinheritance"})},b=function(t,e,r){return endpointUri+=",roledefid="+r+")",_(t+="/roleassignments/addroleassignment(principalid="+e,{})},m=function(t,e){return _({url:t+="/roleassignments/getbyprincipalid("+e+")",headers:{"X-HTTP-Method":"DELETE"}})},_=function(t){var e={type:"POST",contentType:i},r=x.extend({},e,t);return void 0===r.headers||null===r.headers?r.headers={"X-RequestDigest":s(),accept:i}:x.extend(r.headers,{"X-RequestDigest":s(),accept:i}),x.ajax(r)},w=function(t){var e={type:"GET",contentType:i,headers:{accept:i}},r=x.extend({},e,t);return x.ajax(r)};return{web:h,setSiteUrl:o,setNoMetaData:function(t){u=t?!(i="application/json;odata=nometadata"):(i="application/json;odata=verbose",!0)},getUserProperties:function(t,e){return p=_spPageContextInfo||{},l=l||p.webAbsoluteUrl||"..",w({url:l+"/_api/SP.UserProfiles.PeopleManager/GetUserProfilePropertyFor(accountName=@v,propertyName='"+e+"')?@v='i:0%23.f|membership|"+t+"'"})},getAllUserProperties:function(t){return p=_spPageContextInfo||{},l=l||p.webAbsoluteUrl||"..",w({url:l+"/_api/SP.UserProfiles.PeopleManager/GetPropertiesFor(accountName=@v)?@v='i:0%23.f|membership|"+encodeURIComponent(t)+"'"})},getAllPropertiesOfCurrentUser:function(){return p=_spPageContextInfo||{},l=l||p.webAbsoluteUrl||"..",w({url:l+"/_api/SP.UserProfiles.PeopleManager/GetMyProperties"})},getRequestDigest:s,setMinimalMetaData:function(t){u=t?!(i="application/json;odata=minimalmetadata"):(i="application/json;odata=verbose",!0)},createNewBatch:t}}}(jQuery);