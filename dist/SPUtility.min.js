"use strict";var SPUtility=function(j){return function(){var e,o=void 0,r=!1,i="application/json;odata=verbose",s=!0,n={},a=_spPageContextInfo||{},l=function(t){o=t,r=!0,n={},u().then(function(t){e=t.d.GetContextWebInformation.FormDigestValue,setTimeout(function(){l(o)},100*t.d.GetContextWebInformation.FormDigestTimeoutSeconds-100)})},u=function(){return C({url:o+"/_api/contextinfo",contentType:"application/json;odata=verbose",headers:{accept:"application/json;odata=verbose"}})},p=function(){return r||(e=e||j("#__REQUESTDIGEST").val()),e},t=function(){this.batchGuid=c(),this.changeSetId=c(),this.batchContents=new Array};t.prototype.addToBatchContent=function(t){this.batchContents.push("--changeset_"+this.changeSetId),this.batchContents.push("Content-Type: application/http"),this.batchContents.push("Content-Transfer-Encoding: binary"),this.batchContents.push(""),this.batchContents.push(t.type+" "+t.url+" HTTP/1.1");for(var e=0;e<t.headers.length;e++){var r=t.headers[e];this.batchContents.push(r)}this.batchContents.push(""),t.data&&(this.batchContents.push(JSON.stringify(t.data)),this.batchContents.push(""))},t.prototype.executeBatch=function(){this.batchContents.push("--changeset_"+this.changeSetId+"--");var t=this.batchContents.join("\r\n");this.batchContents=new Array,this.batchContents.push("--batch_"+this.batchGuid),this.batchContents.push('Content-Type: multipart/mixed; boundary="changeset_'+this.changeSetId+'"'),this.batchContents.push("Content-Length: "+t.length),this.batchContents.push("Content-Transfer-Encoding: binary"),this.batchContents.push(""),this.batchContents.push(t),this.batchContents.push(""),this.batchContents.push("--batch_"+this.batchGuid+"--"),t=this.batchContents.join("\r\n");var e={"X-RequestDigest":p(),"Content-Type":'multipart/mixed; boundary="batch_'+this.batchGuid+'"'},r=o+"/_api/$batch";return this.batchGuid=c(),this.changeSetId=c(),this.batchContents=new Array,C({url:r,headers:e,data:t})};var c=function(){var r=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=(r+16*Math.random())%16|0;return r=Math.floor(r/16),("x"==t?e:3&e|8).toString(16)})},d=function(t){this.endPointUrl=t};d.prototype.select=function(t){return t&&(this.selectArray=t.join(",")),this},d.prototype.filter=function(t){return t&&(this.filterValue=t),this},d.prototype.get=function(){var t=this.endPointUrl,e={};return this.selectArray&&(e.$select=this.selectArray),this.filterValue&&(e.$filter=this.filterValue),v({url:t+"/Fields",data:j.param(e)})};var h=(a=_spPageContextInfo||{},o=o||a.webAbsoluteUrl||"..",{lists:(x=I="",L=function(){var t=o;return"getbytitle"===I.toLowerCase()?t+="/_api/lists/getbytitle('"+x+"')":"getbyid"===I.toLowerCase()&&(t+="/_api/lists(guid'"+x+"')"),v({url:t})},A=function(t,e){var r=o;return"getbytitle"===I.toLowerCase()?r+="/_api/lists/getbytitle('"+x+"')":"getbyid"===I.toLowerCase()&&(r+="/_api/lists(guid'"+x+"')"),t.__metadata={type:"SP.List"},C({url:r,body:t,headers:{"IF-MATCH":e,"X-HTTP-Method":"MERGE"}})},T=function(t){var e=o;return"getbytitle"===I.toLowerCase()?e+="/_api/lists/getbytitle('"+x+"')":"getbyid"===I.toLowerCase()&&(e+="/_api/lists(guid'"+x+"')"),C({url:e,headers:{"IF-MATCH":t,"X-HTTP-Method":"DELETE"}})},E=function(){var t=o,e=j.Deferred();return"getbytitle"===I.toLowerCase()?t+="/_api/lists/getbytitle('"+x+"')?$select=ListItemEntityTypeFullName":"getbyid"===I.toLowerCase()&&(t+="/_api/lists(guid'"+x+"')?$select=ListItemEntityTypeFullName"),n.listTitleOrId===x?e.resolve(n.MetaData):v({url:t,contentType:"application/json;odata=verbose",headers:{accept:"application/json;odata=verbose"}}).then(function(t){n={listTitleOrId:x,MetaData:t},e.resolve(t)},function(t){e.reject(t)}),e.promise()},B=function(t,e){return v({url:t+"/"+e})},(D=function(){}).prototype.select=function(t){return t&&(this.selectArray=t.join(",")),this},D.prototype.expand=function(t){return t&&(this.expandArray=t.join(",")),this},D.prototype.filter=function(t){return t&&(this.filterValue=t),this},D.prototype.topItem=function(t){return t&&(this.top=t),this},D.prototype.orderBy=function(t){return t&&(this.order=t.join(",")),this},D.prototype.get=function(){var t={};return this.selectArray&&(t.$select=this.selectArray),this.expandArray&&(t.$expand=this.expandArray),this.filterValue&&(t.$filter=this.filterValue),this.top&&(t.$top=this.top),this.order&&(t.$orderby=this.order),"getbytitle"===I.toLowerCase()?v({url:o+"/_api/lists/getbytitle('"+x+"')/items",data:j.param(t)}):"getbyid"===I.toLowerCase()?v({url:o+"/_api/lists(guid'"+x+"')/items",data:j.param(t)}):void 0},D.prototype.getAllItems=function(){var r=j.Deferred(),t={},e=o,i=[];"getbytitle"===I.toLowerCase()?e+="/_api/lists/getbytitle('"+x+"')/items":"getbyid"===I.toLowerCase()&&(e+="/_api/lists(guid'"+x+"')/items"),this.selectArray&&(t.$select=this.selectArray),this.expandArray&&(t.$expand=this.expandArray),this.filterValue&&(t.$filter=this.filterValue),this.order&&(t.$orderby=this.order),t.$top=4999,this.top&&(t.$top=this.top);var n=function(t,e){v({url:t,data:j.param(e)}).then(function(t){s?(i=j.merge(i,t.d.results),t.d.__next?n(t.d.__next,""):r.resolve(i)):(i=j.merge(i,t.value),t["odata.nextLink"]?n(t["odata.nextLink"],""):r.resolve(i))},function(t){console.error("Error occurred while loading the items",t),r.reject(t)})};return n(e,t),r.promise()},D.prototype.getPaged=function(){var r=j.Deferred(),t={},e=o;"getbytitle"===I.toLowerCase()?e+="/_api/lists/getbytitle('"+x+"')/items":"getbyid"===I.toLowerCase()&&(e+="/_api/lists(guid'"+x+"')/items"),this.selectArray&&(t.$select=this.selectArray),this.expandArray&&(t.$expand=this.expandArray),this.filterValue&&(t.$filter=this.filterValue),this.order&&(t.$orderby=this.order),t.$top=4999,this.top&&(t.$top=this.top);var i=function(t,e){var r=j.Deferred();return v({url:t,data:j.param(e)}).then(function(t){if(s?t.d.__next:t["odata.nextLink"]){var e=function(t){this.nextUrlLink=t};e.prototype.getNextItems=function(){return i(this.nextUrlLink,"")},s?r.resolve(t.d.results,new e(t.d.__next)):r.resolve(t.value,new e(t["odata.nextLink"]))}else s?r.resolve(t.d.results):r.resolve(t.value)},function(t){console.error("Error occurred while loading the items",t),r.reject(t)}),r.promise()};return i(e,t).then(function(t,e){e?r.resolve(t,e):r.resolve(t)},function(t){r.reject(t)}),r.promise()},D.prototype.getItemById=function(t){var e={},r=o;return this.selectArray&&(e.$select=this.selectArray),this.expandArray&&(e.$expand=this.expandArray),"getbytitle"===I.toLowerCase()?r+="/_api/lists/getbytitle('"+x+"')/getItemById('"+t+"')":"getbyid"===I.toLowerCase()&&(r+="/_api/lists(guid'"+x+"')/getItemById('"+t+"')"),v({url:r,data:j.param(e)})},D.prototype.addNewItem=function(e){var r=j.Deferred(),i=o;return"getbytitle"===I.toLowerCase()?i+="/_api/lists/getbytitle('"+x+"')/items":"getbyid"===I.toLowerCase()&&(i+="/_api/lists(guid'"+x+"')/items"),E().then(function(t){e.__metadata={type:t.d.ListItemEntityTypeFullName},C({url:i,data:JSON.stringify(e),contentType:"application/json;odata=verbose",headers:{accept:"application/json;odata=verbose"}}).then(function(t){r.resolve(t)},function(t){r.reject(t)})},function(t){console.error("Error occurred while loading List Metadata",t),r.reject(t)}),r.promise()},D.prototype.addNewItemUsingBatch=function(e,r){var i=o;"getbytitle"===I.toLowerCase()?i+="/_api/lists/getbytitle('"+x+"')/items":"getbyid"===I.toLowerCase()&&(i+="/_api/lists(guid'"+x+"')/items"),E().then(function(t){e.__metadata={type:t.d.ListItemEntityTypeFullName},r.addToBatchContent({url:i,type:"POST",headers:["Content-Type: application/json;odata=verbose"],data:e})},function(t){console.error("Error occurred",t)})},D.prototype.uploadAttachment=function(t,e){var r=j.Deferred(),i=o+"/_api";return"getbytitle"===I.toLowerCase()?i+="/lists/getbytitle('"+x+"')/items('"+t+"')/AttachmentFiles/add(FileName='"+e.name+"')":"getbyid"===I.toLowerCase()&&(i+="/lists(guid'"+x+"')/items('"+t+"')/AttachmentFiles/add(FileName='"+e.name+"')"),w(e).then(function(t){C({url:i,data:t,processData:!1,headers:{accept:"application/json;odata=verbose"}}).then(function(t){r.resolve(t)},function(t){console.error("Error occurred while uploading the file",t),r.reject(t)})},function(t){console.error("Error occurred while reading the file",t),r.reject(t)}),r.promise()},D.prototype.getAttachments=function(t){var e=o+"/_api";return"getbytitle"===I.toLowerCase()?e+="/lists/getbytitle('"+x+"')/items('"+t+"')/AttachmentFiles":"getbyid"===I.toLowerCase()&&(e+="/lists(guid'"+x+"')/items('"+t+"')/AttachmentFiles"),v({url:e})},D.prototype.deleteAttachment=function(t,e){var r=o+"/_api";return"getbytitle"===I.toLowerCase()?r+="/lists/getbytitle('"+x+"')/items('"+t+"')/AttachmentFiles/getByFileName('"+e+"')":"getbyid"===I.toLowerCase()&&(r+="/lists(guid'"+x+"')/items('"+t+"')/AttachmentFiles/getByFileName('"+e+"')"),C({url:r,headers:{"X-HTTP-Method":"DELETE"}})},D.prototype.updateItem=function(t,e,r){var i=j.Deferred(),n=o;return"getbytitle"===I.toLowerCase()?n+="/_api/lists/getbytitle('"+x+"')/getItemById('"+t+"')":"getbyid"===I.toLowerCase()&&(n+="/_api/lists(guid'"+x+"')/getItemById('"+t+"')"),E().then(function(t){r.__metadata={type:t.d.ListItemEntityTypeFullName},C({url:n,data:JSON.stringify(r),contentType:"application/json;odata=verbose",headers:{accept:"application/json;odata=verbose","X-HTTP-Method":"MERGE","If-Match":e}}).then(function(t){i.resolve(t)},function(t){i.reject(t)})},function(t){console.error("Error occurred while loading List Metadata",t),i.reject(t)}),i.promise()},D.prototype.updateItemUsingBatch=function(t,e,r,i){var n=o;"getbytitle"===I.toLowerCase()?n+="/_api/lists/getbytitle('"+x+"')/getItemById('"+t+"')":"getbyid"===I.toLowerCase()&&(n+="/_api/lists(guid'"+x+"')/getItemById('"+t+"')"),E().then(function(t){r.__metadata={type:t.d.ListItemEntityTypeFullName},i.addToBatchContent({url:n,type:"PATCH",headers:["Content-Type: application/json;odata=verbose","If-Match: "+e],data:r})},function(t){console.error("Error occurred",t)})},D.prototype.deleteItem=function(t,e){var r=o;return"getbytitle"===I.toLowerCase()?r+="/_api/lists/getbytitle('"+x+"')/getItemById('"+t+"')":"getbyid"===I.toLowerCase()&&(r+="/_api/lists(guid'"+x+"')/getItemById('"+t+"')"),C({url:r,contentType:"application/json;odata=verbose",headers:{accept:"application/json;odata=verbose","X-HTTP-Method":"DELETE","If-Match":e}})},D.prototype.deleteItemUsingBatch=function(t,e,r){var i=o;"getbytitle"===I.toLowerCase()?i+="/_api/lists/getbytitle('"+x+"')/getItemById('"+t+"')":"getbyid"===I.toLowerCase()&&(i+="/_api/lists(guid'"+x+"')/getItemById('"+t+"')"),r.addToBatchContent({url:i,type:"DELETE",headers:["Content-Type: application/json;odata=verbose","If-Match: "+e]})},D.prototype.effectiveBasePermissions=function(t){var e=o;return"getbytitle"===I.toLowerCase()?e+="/_api/lists/getbytitle('"+x+"')/getItemById('"+t+"')":"getbyid"===I.toLowerCase()&&(e+="/_api/lists(guid'"+x+"')/getItemById('"+t+"')"),y(e)},D.prototype.hasuniqueroleassignments=function(t){var e=o;return"getbytitle"===I.toLowerCase()?e+="/_api/lists/getbytitle('"+x+"')/getItemById('"+t+"')":"getbyid"===I.toLowerCase()&&(e+="/_api/lists(guid'"+x+"')/getItemById('"+t+"')"),g(e)},D.prototype.breakroleinheritance=function(t,e,r){var i=o;return"getbytitle"===I.toLowerCase()?i+="/_api/lists/getbytitle('"+x+"')/getItemById('"+t+"')":"getbyid"===I.toLowerCase()&&(i+="/_api/lists(guid'"+x+"')/getItemById('"+t+"')"),f(i,e,r)},D.prototype.resetroleinheritance=function(t){var e=o;return"getbytitle"===I.toLowerCase()?e+="/_api/lists/getbytitle('"+x+"')/getItemById('"+t+"')":"getbyid"===I.toLowerCase()&&(e+="/_api/lists(guid'"+x+"')/getItemById('"+t+"')"),b(e)},D.prototype.addRoleAssignment=function(t,e,r){var i=o;return"getbytitle"===I.toLowerCase()?i+="/_api/lists/getbytitle('"+x+"')/getItemById('"+t+"')":"getbyid"===I.toLowerCase()&&(i+="/_api/lists(guid'"+x+"')/getItemById('"+t+"')"),m(i,e,r)},D.prototype.deleteRoleAssignment=function(t,e){var r=o;return"getbytitle"===I.toLowerCase()?r+="/_api/lists/getbytitle('"+x+"')/getItemById('"+t+"')":"getbyid"===I.toLowerCase()&&(r+="/_api/lists(guid'"+x+"')/getItemById('"+t+"')"),_(r,e)},{getListByTitle:function(t){if(!t)throw new Error("List Title cannot be empty or null");return I="getbytitle",x=t,{Items:new D,get:L,updateList:A,deleteList:T,hasuniqueroleassignments:function(){return g(o+"/_api/lists/getbytitle('"+x+"')")},effectiveBasePermissions:function(){return y(o+"/_api/lists/getbytitle('"+x+"')")},breakroleinheritance:function(t,e){return f(o+"/_api/lists/getbytitle('"+x+"')",t,e)},resetroleinheritance:function(){return b(o+"/_api/lists/getbytitle('"+x+"')")},addRoleAssignment:function(t,e){return m(o+"/_api/lists/getbytitle('"+x+"')",t,e)},deleteRoleAssignment:function(t){return _(o+"/_api/lists/getbytitle('"+x+"')",t)},getDefaultDisplayFormUrl:function(){return B(o+"/_api/lists/getbytitle('"+x+"')","DefaultDisplayFormUrl")},getDefaultEditFormUrl:function(){return B(o+"/_api/lists/getbytitle('"+x+"')","DefaultEditFormUrl")},getDefaultNewFormUrl:function(){return B(o+"/_api/lists/getbytitle('"+x+"')","DefaultNewFormUrl")},Fields:new d(o+"/_api/lists/getbytitle('"+x+"')")}},getListById:function(t){if(!t)throw new Error("List Id cannot be empty or null");return I="getbyid",x=t,{Items:new D,get:L,updateList:A,deleteList:T,hasuniqueroleassignments:function(){return g(o+"/_api/lists(guid'"+x+"')")},effectiveBasePermissions:function(){return y(o+"/_api/lists(guid'"+x+"')")},breakroleinheritance:function(t,e){return f(o+"/_api/lists(guid'"+x+"')",t,e)},resetroleinheritance:function(){return b(o+"/_api/lists(guid'"+x+"')")},addRoleAssignment:function(t,e){return m(o+"/_api/lists(guid'"+x+"')",t,e)},deleteRoleAssignment:function(t){return _(o+"/_api/lists(guid'"+x+"')",t)},getDefaultDisplayFormUrl:function(){return B(o+"/_api/lists(guid'"+x+"')","DefaultDisplayFormUrl")},getDefaultEditFormUrl:function(){return B(o+"/_api/lists(guid'"+x+"')","DefaultEditFormUrl")},getDefaultNewFormUrl:function(){return B(o+"/_api/lists(guid'"+x+"')","DefaultNewFormUrl")},Fields:new d(o+"/_api/lists(guid'"+x+"')")}},createList:function(t,e,r,i,n){return C({url:o+"/_api/web/lists",body:{__metadata:{type:"SP.List"},AllowContentTypes:t,BaseTemplate:e,ContentTypesEnabled:r,Description:i,Title:n}})}}),ensureUser:function(t){if(!t)throw new Error("Logon Name cannot be null");var e={logonName:t};return C({url:o+"/_api/web/ensureuser",data:JSON.stringify(e)})},currentUser:function(){return v({url:o+"/_api/web/CurrentUser"})},siteGroups:function(){var r,i,t=function(){};t.prototype.select=function(t){return t&&(this.selectArray=t.join(",")),this},t.prototype.expand=function(t){return t&&(this.expandArray=t.join(",")),this},t.prototype.filter=function(t){return t&&(this.filterValue=t),this},t.prototype.getAllGroups=function(){var t={};return this.selectArray&&(t.$select=this.selectArray),this.expandArray&&(t.$expand=this.expandArray),this.filterValue&&(t.$filter=this.filterValue),v({url:o+"/_api/web/sitegroups",data:j.param(t)})},t.prototype.getByName=function(t){return i="getbyname",r=t,{users:new e,get:function(){return v({url:o+"/_api/web/sitegroups/getbyname('"+t+"')"})}}},t.prototype.getById=function(t){return i="getbyid",r=t,{users:new e,get:function(){return v({url:o+"/_api/web/sitegroups/getbyid('"+t+"')"})}}};var e=function(){};return e.prototype.select=function(t){return t&&(this.selectArray=t.join(",")),this},e.prototype.expand=function(t){return t&&(this.expandArray=t.join(",")),this},e.prototype.filter=function(t){return t&&(this.filterValue=t),this},e.prototype.get=function(){var t={},e=o+"/_api/web/sitegroups/";return"getbyname"===i.toLowerCase()?e+="getbyname('"+r+"')/users":"getbyid"===i.toLowerCase()&&(e+="getbyid("+r+")/users"),this.selectArray&&(t.$select=this.selectArray),this.expandArray&&(t.$expand=this.expandArray),this.filterValue&&(t.$filter=this.filterValue),v({url:e,data:j.param(t)})},{groups:new t}}(),getRoles:function(){return v({url:o+"/_api/web/roleDefinitions"})},hasuniqueroleassignments:function(){return g(o+"/_api/web")},effectiveBasePermissions:function(){return y(o+"/_api/web")},breakroleinheritance:function(t,e){return f(o+"/_api/web",t,e)},resetroleinheritance:function(){return b(o+"/_api/web")},addRoleAssignment:function(t,e){return m(o+"/_api/web",t,e)},deleteRoleAssignment:function(t){return _(o+"/_api/web",t)},siteColumns:function(){return{Fields:new d(o+"/_api/web")}}}),y=function(t){return v({url:t+="/effectiveBasePermissions"})},g=function(t){return C({url:t+="/hasuniqueroleassignments"})},f=function(t,e,r){return t+="/breakroleinheritance(copyRoleAssignments="+e.toString()+",clearSubscopes="+r.toString()+")",C({url:t})},b=function(t){return C({url:t+="/resetroleinheritance"})},m=function(t,e,r){return endpointUri+=",roledefid="+r+")",C(t+="/roleassignments/addroleassignment(principalid="+e,{})},_=function(t,e){return C({url:t+="/roleassignments/getbyprincipalid("+e+")",headers:{"X-HTTP-Method":"DELETE"}})},w=function(t){var e=j.Deferred(),r=new FileReader;return r.onload=function(t){e.resolve(t.target.result)},r.onerror=function(t){e.reject(t.target.error)},r.readAsArrayBuffer(t),e.promise()},C=function(t){var e={type:"POST",contentType:i},r=j.extend({},e,t);return void 0===r.headers||null===r.headers?r.headers={"X-RequestDigest":p(),accept:i}:j.extend(r.headers,{"X-RequestDigest":p(),accept:i}),j.ajax(r)},v=function(t){var e={type:"GET",contentType:i,headers:{accept:i}},r=j.extend({},e,t);return j.ajax(r)};var I,x,L,A,T,E,B,D;return{web:h,setSiteUrl:l,setNoMetaData:function(t){s=t?!(i="application/json;odata=nometadata"):(i="application/json;odata=verbose",!0)},getUserProperties:function(t,e){return a=_spPageContextInfo||{},o=o||a.webAbsoluteUrl||"..",v({url:o+"/_api/SP.UserProfiles.PeopleManager/GetUserProfilePropertyFor(accountName=@v,propertyName='"+e+"')?@v='i:0%23.f|membership|"+t+"'"})},getAllUserProperties:function(t){return a=_spPageContextInfo||{},o=o||a.webAbsoluteUrl||"..",v({url:o+"/_api/SP.UserProfiles.PeopleManager/GetPropertiesFor(accountName=@v)?@v='i:0%23.f|membership|"+encodeURIComponent(t)+"'"})},getAllPropertiesOfCurrentUser:function(){return a=_spPageContextInfo||{},o=o||a.webAbsoluteUrl||"..",v({url:o+"/_api/SP.UserProfiles.PeopleManager/GetMyProperties"})},getRequestDigest:p,setMinimalMetaData:function(t){s=t?!(i="application/json;odata=minimalmetadata"):(i="application/json;odata=verbose",!0)},createNewBatch:t}}}(jQuery);