!function(w){window.SPUtility=function(){var e,u=void 0,r=!1,l="application/json;odata=verbose",p=!0,i={},n=function(t){u=t,r=!0,i={},s().then(function(t){e=t.d.GetContextWebInformation.FormDigestValue,setTimeout(function(){n(u)},100*t.d.GetContextWebInformation.FormDigestTimeoutSeconds-100)})},s=function(){return m({url:u+"/_api/contextinfo"})},o=function(){return r||(e=e||w("#__REQUESTDIGEST").val()),e},t=function(){this.batchGuid=a(),this.changeSetId=a(),this.batchContents=new Array};t.prototype.addToBatchContent=function(t){this.batchContents.push("--changeset_"+this.changeSetId),this.batchContents.push("Content-Type: application/http"),this.batchContents.push("Content-Transfer-Encoding: binary"),this.batchContents.push(""),this.batchContents.push(t.type+" "+t.url+" HTTP/1.1");for(var e=0;e<t.headers.length;e++){var r=t.headers[e];this.batchContents.push(r)}this.batchContents.push(""),t.data&&(this.batchContents.push(JSON.stringify(t.data)),this.batchContents.push(""))},t.prototype.executeBatch=function(){this.batchContents.push("--changeset_"+this.changeSetId+"--");var t=this.batchContents.join("\r\n");this.batchContents=new Array,this.batchContents.push("--batch_"+this.batchGuid),this.batchContents.push('Content-Type: multipart/mixed; boundary="changeset_'+this.changeSetId+'"'),this.batchContents.push("Content-Length: "+t.length),this.batchContents.push("Content-Transfer-Encoding: binary"),this.batchContents.push(""),this.batchContents.push(t),this.batchContents.push(""),this.batchContents.push("--batch_"+this.batchGuid+"--"),t=this.batchContents.join("\r\n");var e={"X-RequestDigest":o(),"Content-Type":'multipart/mixed; boundary="batch_'+this.batchGuid+'"'},r=u+"/_api/$batch";return this.batchGuid=a(),this.changeSetId=a(),this.batchContents=new Array,m({url:r,headers:e,data:t})};var a=function(){var r=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=(r+16*Math.random())%16|0;return r=Math.floor(r/16),("x"==t?e:3&e|8).toString(16)})},c=function(t){this.endPointUrl=t};c.prototype.select=function(t){return t&&(this.selectArray=t.join(",")),this},c.prototype.filter=function(t){return t&&(this.filterValue=t),this},c.prototype.get=function(){var t=this.endPointUrl,e={};return this.selectArray&&(e.$select=this.selectArray),this.filterValue&&(e.$filter=this.filterValue),_({url:t+"/Fields",data:w.param(e)})};var d=function(){u=u||_spPageContextInfo.webAbsoluteUrl||"..";var s,o,a,e,r;return{lists:(o=s="",a=function(){var t=u,e=w.Deferred();return"getbytitle"===s.toLowerCase()?t+="/_api/lists/getbytitle('"+o+"')?$select=ListItemEntityTypeFullName":"getbyid"===s.toLowerCase()&&(t+="/_api/lists(guid'"+o+"')?$select=ListItemEntityTypeFullName"),i.listTitleOrId===o?e.resolve(i.MetaData):_({url:t}).then(function(t){i={listTitleOrId:o,MetaData:t},e.resolve(t)},function(t){e.reject(t)}),e.promise()},e=function(t,e){return _({url:t+"/"+e})},(r=function(){}).prototype.select=function(t){return t&&(this.selectArray=t.join(",")),this},r.prototype.expand=function(t){return t&&(this.expandArray=t.join(",")),this},r.prototype.filter=function(t){return t&&(this.filterValue=t),this},r.prototype.topItem=function(t){return t&&(this.top=t),this},r.prototype.orderBy=function(t){return t&&(this.order=t.join(",")),this},r.prototype.get=function(){var t={};return this.selectArray&&(t.$select=this.selectArray),this.expandArray&&(t.$expand=this.expandArray),this.filterValue&&(t.$filter=this.filterValue),this.top&&(t.$top=this.top),this.order&&(t.$orderby=this.order),"getbytitle"===s.toLowerCase()?_({url:u+"/_api/lists/getbytitle('"+o+"')/items",data:w.param(t)}):"getbyid"===s.toLowerCase()?_({url:u+"/_api/lists(guid'"+o+"')/items",data:w.param(t)}):void 0},r.prototype.getAllItems=function(){var r=w.Deferred(),t={},e=u,i=[];"getbytitle"===s.toLowerCase()?e+="/_api/lists/getbytitle('"+o+"')/items":"getbyid"===s.toLowerCase()&&(e+="/_api/lists(guid'"+o+"')/items"),this.selectArray&&(t.$select=this.selectArray),this.expandArray&&(t.$expand=this.expandArray),this.filterValue&&(t.$filter=this.filterValue),this.order&&(t.$orderby=this.order),t.$top=4999,this.top&&(t.$top=this.top);var n=function(t,e){_({url:t,data:w.param(e)}).then(function(t){p?(i=w.merge(i,t.d.results),t.d.__next?n(t.d.__next,""):r.resolve(i)):(i=w.merge(i,t.value),t["odata.nextLink"]?n(t["odata.nextLink"],""):r.resolve(i))},function(t){console.error("Error occurred while loading the items",t),r.reject(t)})};return n(e,t),r.promise()},r.prototype.getPaged=function(){var r=w.Deferred(),t={},e=u;"getbytitle"===s.toLowerCase()?e+="/_api/lists/getbytitle('"+o+"')/items":"getbyid"===s.toLowerCase()&&(e+="/_api/lists(guid'"+o+"')/items"),this.selectArray&&(t.$select=this.selectArray),this.expandArray&&(t.$expand=this.expandArray),this.filterValue&&(t.$filter=this.filterValue),this.order&&(t.$orderby=this.order),t.$top=4999,this.top&&(t.$top=this.top);var i=function(t,e){var r=w.Deferred();return _({url:t,data:w.param(e)}).then(function(t){if(p?t.d.__next:t["odata.nextLink"]){var e=function(t){this.nextUrlLink=t};e.prototype.getNextItems=function(){return i(this.nextUrlLink,"")},p?r.resolve(t.d.results,new e(t.d.__next)):r.resolve(t.value,new e(t["odata.nextLink"]))}else p?r.resolve(t.d.results):r.resolve(t.value)},function(t){console.error("Error occurred while loading the items",t),r.reject(t)}),r.promise()};return i(e,t).then(function(t,e){e?r.resolve(t,e):r.resolve(t)},function(t){r.reject(t)}),r.promise()},r.prototype.getItemById=function(t){var e={},r=u;return this.selectArray&&(e.$select=this.selectArray),this.expandArray&&(e.$expand=this.expandArray),"getbytitle"===s.toLowerCase()?r+="/_api/lists/getbytitle('"+o+"')/getItemById('"+t+"')":"getbyid"===s.toLowerCase()&&(r+="/_api/lists(guid'"+o+"')/getItemById('"+t+"')"),_({url:r,data:w.param(e)})},r.prototype.addNewItem=function(e){var r=w.Deferred(),i=u;return"getbytitle"===s.toLowerCase()?i+="/_api/lists/getbytitle('"+o+"')/items":"getbyid"===s.toLowerCase()&&(i+="/_api/lists(guid'"+o+"')/items"),a().then(function(t){e.__metadata={type:t.d.ListItemEntityTypeFullName},m({url:i,data:JSON.stringify(e)}).then(function(t){r.resolve(t)},function(t){r.reject(t)})},function(t){console.error("Error occurred while loading List Metadata",t),r.reject(t)}),r.promise()},r.prototype.addNewItemUsingBatch=function(e,r){var i=u;"getbytitle"===s.toLowerCase()?i+="/_api/lists/getbytitle('"+o+"')/items":"getbyid"===s.toLowerCase()&&(i+="/_api/lists(guid'"+o+"')/items"),a().then(function(t){e.__metadata={type:t.d.ListItemEntityTypeFullName},r.addToBatchContent({url:i,type:"POST",headers:["Content-Type: "+l],data:e})},function(t){console.error("Error occurred",t)})},r.prototype.updateItem=function(t,e,r){var i=w.Deferred(),n=u;return"getbytitle"===s.toLowerCase()?n+="/_api/lists/getbytitle('"+o+"')/getItemById('"+t+"')":"getbyid"===s.toLowerCase()&&(n+="/_api/lists(guid'"+o+"')/getItemById('"+t+"')"),a().then(function(t){r.__metadata={type:t.d.ListItemEntityTypeFullName},m({url:n,data:JSON.stringify(r),headers:{"X-HTTP-Method":"MERGE","If-Match":e}}).then(function(t){i.resolve(t)},function(t){i.reject(t)})},function(t){console.error("Error occurred while loading List Metadata",t),i.reject(t)}),i.promise()},r.prototype.updateItemUsingBatch=function(t,e,r,i){var n=u;"getbytitle"===s.toLowerCase()?n+="/_api/lists/getbytitle('"+o+"')/getItemById('"+t+"')":"getbyid"===s.toLowerCase()&&(n+="/_api/lists(guid'"+o+"')/getItemById('"+t+"')"),a().then(function(t){r.__metadata={type:t.d.ListItemEntityTypeFullName},i.addToBatchContent({url:n,type:"PATCH",headers:["Content-Type: "+l,"If-Match: "+e],data:r})},function(t){console.error("Error occurred",t)})},r.prototype.deleteItem=function(t,e){var r=u;return"getbytitle"===s.toLowerCase()?r+="/_api/lists/getbytitle('"+o+"')/getItemById('"+t+"')":"getbyid"===s.toLowerCase()&&(r+="/_api/lists(guid'"+o+"')/getItemById('"+t+"')"),m({url:r,headers:{"X-HTTP-Method":"DELETE","If-Match":e}})},r.prototype.deleteItemUsingBatch=function(t,e,r){var i=u;"getbytitle"===s.toLowerCase()?i+="/_api/lists/getbytitle('"+o+"')/getItemById('"+t+"')":"getbyid"===s.toLowerCase()&&(i+="/_api/lists(guid'"+o+"')/getItemById('"+t+"')"),r.addToBatchContent({url:i,type:"DELETE",headers:["Content-Type: "+l,"If-Match: "+e]})},r.prototype.hasuniqueroleassignments=function(t){var e=u;return"getbytitle"===s.toLowerCase()?e+="/_api/lists/getbytitle('"+o+"')/getItemById('"+t+"')":"getbyid"===s.toLowerCase()&&(e+="/_api/lists(guid'"+o+"')/getItemById('"+t+"')"),h(e)},r.prototype.breakroleinheritance=function(t,e,r){var i=u;return"getbytitle"===s.toLowerCase()?i+="/_api/lists/getbytitle('"+o+"')/getItemById('"+t+"')":"getbyid"===s.toLowerCase()&&(i+="/_api/lists(guid'"+o+"')/getItemById('"+t+"')"),y(i,e,r)},r.prototype.resetroleinheritance=function(t){var e=u;return"getbytitle"===s.toLowerCase()?e+="/_api/lists/getbytitle('"+o+"')/getItemById('"+t+"')":"getbyid"===s.toLowerCase()&&(e+="/_api/lists(guid'"+o+"')/getItemById('"+t+"')"),g(e)},r.prototype.addRoleAssignment=function(t,e,r){var i=u;return"getbytitle"===s.toLowerCase()?i+="/_api/lists/getbytitle('"+o+"')/getItemById('"+t+"')":"getbyid"===s.toLowerCase()&&(i+="/_api/lists(guid'"+o+"')/getItemById('"+t+"')"),f(i,e,r)},r.prototype.deleteRoleAssignment=function(t,e){var r=u;return"getbytitle"===s.toLowerCase()?r+="/_api/lists/getbytitle('"+o+"')/getItemById('"+t+"')":"getbyid"===s.toLowerCase()&&(r+="/_api/lists(guid'"+o+"')/getItemById('"+t+"')"),b(r,e)},{getListByTitle:function(t){if(!t)throw new Error("List Title cannot be empty or null");return s="getbytitle",o=t,{Items:new r,hasuniqueroleassignments:function(){return h(u+"/_api/lists/getbytitle('"+o+"')")},breakroleinheritance:function(t,e){return y(u+"/_api/lists/getbytitle('"+o+"')",t,e)},resetroleinheritance:function(){return g(u+"/_api/lists/getbytitle('"+o+"')")},addRoleAssignment:function(t,e){return f(u+"/_api/lists/getbytitle('"+o+"')",t,e)},deleteRoleAssignment:function(t){return b(u+"/_api/lists/getbytitle('"+o+"')",t)},getDefaultDisplayFormUrl:function(){return e(u+"/_api/lists/getbytitle('"+o+"')","DefaultDisplayFormUrl")},getDefaultEditFormUrl:function(){return e(u+"/_api/lists/getbytitle('"+o+"')","DefaultEditFormUrl")},getDefaultNewFormUrl:function(){return e(u+"/_api/lists/getbytitle('"+o+"')","DefaultNewFormUrl")},Fields:new c(u+"/_api/lists/getbytitle('"+o+"')")}},getListById:function(t){if(!t)throw new Error("List Id cannot be empty or null");return s="getbyid",o=t,{Items:new r,hasuniqueroleassignments:function(){return h(u+"/_api/lists(guid'"+o+"')")},breakroleinheritance:function(t,e){return y(u+"/_api/lists(guid'"+o+"')",t,e)},resetroleinheritance:function(){return g(u+"/_api/lists(guid'"+o+"')")},addRoleAssignment:function(t,e){return f(u+"/_api/lists(guid'"+o+"')",t,role)},deleteRoleAssignment:function(t){return b(u+"/_api/lists(guid'"+o+"')",t)},getDefaultDisplayFormUrl:function(){return e(u+"/_api/lists(guid'"+o+"')","DefaultDisplayFormUrl")},getDefaultEditFormUrl:function(){return e(u+"/_api/lists(guid'"+o+"')","DefaultEditFormUrl")},getDefaultNewFormUrl:function(){return e(u+"/_api/lists(guid'"+o+"')","DefaultNewFormUrl")},Fields:new c(u+"/_api/lists(guid'"+o+"')")}}}),ensureUser:function(t){if(!t)throw new Error("Logon Name cannot be null");var e={logonName:t};return m({url:u+"/_api/web/ensureuser",data:JSON.stringify(e)})},currentUser:function(){return _({url:u+"/_api/web/CurrentUser"})},siteGroups:function(){var r,i,t=function(){};t.prototype.select=function(t){return t&&(this.selectArray=t.join(",")),this},t.prototype.expand=function(t){return t&&(this.expandArray=t.join(",")),this},t.prototype.filter=function(t){return t&&(this.filterValue=t),this},t.prototype.getAllGroups=function(){var t={};return this.selectArray&&(t.$select=this.selectArray),this.expandArray&&(t.$expand=this.expandArray),this.filterValue&&(t.$filter=this.filterValue),_({url:u+"/_api/web/sitegroups",data:w.param(t)})},t.prototype.getByName=function(t){i="getbyname",r=t;return{users:new e,get:function(){return _({url:u+"/_api/web/sitegroups/getbyname('"+t+"')"})}}},t.prototype.getById=function(t){i="getbyid",r=t;return{users:new e,get:function(){return _({url:u+"/_api/web/sitegroups/getbyid('"+t+"')"})}}};var e=function(){};return e.prototype.select=function(t){return t&&(this.selectArray=t.join(",")),this},e.prototype.expand=function(t){return t&&(this.expandArray=t.join(",")),this},e.prototype.filter=function(t){return t&&(this.filterValue=t),this},e.prototype.get=function(){var t={},e=u+"/_api/web/sitegroups/";return"getbyname"===i.toLowerCase()?e+="getbyname('"+r+"')/users":"getbyid"===i.toLowerCase()&&(e+="getbyid("+r+")/users"),this.selectArray&&(t.$select=this.selectArray),this.expandArray&&(t.$expand=this.expandArray),this.filterValue&&(t.$filter=this.filterValue),_({url:e,data:w.param(t)})},{groups:new t}}(),getRoles:function(){return _({url:u+"/_api/web/roleDefinitions"})},hasuniqueroleassignments:function(){return h(u+"/_api/web")},breakroleinheritance:function(t,e){return y(u+"/_api/web",t,e)},resetroleinheritance:function(){return g(u+"/_api/web")},addRoleAssignment:function(t,e){return f(u+"/_api/web",t,e)},deleteRoleAssignment:function(t){return b(u+"/_api/web",t)},siteColumns:function(){return{Fields:new c(u+"/_api/web")}}}}(),h=function(t){return m({url:t+="/hasuniqueroleassignments"})},y=function(t,e,r){return t+="/breakroleinheritance(copyRoleAssignments="+e.toString()+",clearSubscopes="+r.toString()+")",m({url:t})},g=function(t){return m({url:t+="/resetroleinheritance"})},f=function(t,e,r){return endpointUri+=",roledefid="+r+")",m(t+="/roleassignments/addroleassignment(principalid="+e,{})},b=function(t,e){return m({url:t+="/roleassignments/getbyprincipalid("+e+")",headers:{"X-HTTP-Method":"DELETE"}})},m=function(t){var e={type:"POST",contentType:l},r=w.extend({},e,t);return void 0===r.headers||null===r.headers?r.headers={"X-RequestDigest":o(),accept:l}:w.extend(r.headers,{"X-RequestDigest":o(),accept:l}),w.ajax(r)},_=function(t){var e={type:"GET",contentType:l,headers:{accept:l}},r=w.extend({},e,t);return w.ajax(r)};return{web:d,setSiteUrl:n,setNoMetaData:function(t){p=t?!(l="application/json;odata=nometadata"):(l="application/json;odata=verbose",!0)},getUserProperties:function(t,e){return u=u||_spPageContextInfo.webAbsoluteUrl||"..",_({url:u+"/_api/SP.UserProfiles.PeopleManager/GetUserProfilePropertyFor(accountName=@v,propertyName='"+e+"')?@v='i:0%23.f|membership|"+t+"'"})},getAllUserProperties:function(t){return u=u||_spPageContextInfo.webAbsoluteUrl||"..",_({url:u+"/_api/SP.UserProfiles.PeopleManager/GetPropertiesFor(accountName=@v)?@v='i:0%23.f|membership|"+encodeURIComponent(t)+"'"})},getRequestDigest:o,setMinimalMetaData:function(t){p=t?!(l="application/json;odata=minimalmetadata"):(l="application/json;odata=verbose",!0)},createNewBatch:t}}()}(jQuery);